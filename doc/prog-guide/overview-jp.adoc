== 概要

この章では、関数型言語とオブジェクト指向を
理解するのに必要となる、基本の概念と用語を説明します。
すでに分かっている人であれば、 読み飛ばしてもかまいません。


=== 評価

```
人間：「３と４を足すといくつ？]
計算機：「７です]
```

計算機(computer)は
人間からの質問(question)に対して答え(answer)を返します。

image::compute.png[align="center"]

この処理を関数型言語では評価(evaluation)と呼び、
人間から受ける質問の事を文(statemennt)、
そして人間へ返す答えの事を作用(effect)と呼びます。

image::evaluate.png[align="center"]

```
umu:1> 3 + 4
val it : Int = 7
```

ここで、文は以下の二つに分類されます。

* 文
** 式
** 宣言

また作用は以下の二つに分類されます。

* 作用
** 値
** 環境

先の実行例であれば、
「式 `3 + 4` を評価した結果は値 `7` である」
と解釈します。 


=== 式と定数

式(expression)とは多くの要素に構成される文の一種です。
その中から、最も単純な二つの構成要素について
評価の方法を以下に示します。

* 定数(constant): [例] `3`
. その値そのものを返します。
* 演算子(operator): [例] `+`
. まずその被演算子(operand)を再帰的に評価し、
. その値を元に演算して結果を返します。

image::eval-const.png[align="center"]


=== 変数と環境

値には名前を付けることができます。
たとえば円周率を表すのに
毎回 `3.14159265358979` と書くのは
面倒ですからそれを `PI` と命名し、
その名前で円周率の値を表すものと解釈します。
ここで、値に付けられた名前の事を変数(variable)と呼び、
名前と値の対応が記録された辞書の事を
環境(environment)と呼びます。

変数は以下のように評価します。

* 変数(variable): [例] `PI`, `TRUE`
. その名前と対応する値を環境(environment)から検索し、
.. 見つかればその値を返し、
.. 見つからなければエラーとします。

image::eval-var.png[align="center"]

```
umu:1> TRUE
val it : Bool = TRUE
umu:2> Umu::Math::PI
val it : Float = 3.141592653589793
umu:3> foo

[NameError] Unbound value identifier: 'foo' -- #3 in "<stdin>"
umu:4>
```

=== 宣言と環境

宣言(declaration)とは変数と式から構成される文の一種であり、
現在の環境(environment)へ新しい変数を登録できるようになります。

宣言は以下のように評価します。

. 現在の環境の下で式を評価し、
. 変数の名前と評価した値の対応を環境へ登録し、
. 次回の評価では登録された新しい環境を参照します。

```
umu:1> val x = 3        # 変数 x を宣言
val x : Int = 3
umu:2> val y = 4        # 変数 x を宣言
val y : Int = 4
umu:3> val z = x + y    # 式 x + y を評価し、変数 z を宣言
val z : Int = 7
umu:4>
```

image::eval-decl.png[align="center"]


=== 作用と副作用

文を評価した時、作用(effect)だけでなく別の結果が生じることがあります。
この副次的に発生する結果を副作用(side effect)と呼びます。

image::side-effect.png[align="center"]

副作用は以下の三つに分類されます。

* 乱数発生
* 入出力
* 破壊的代入
** リファレンス
** S-式

=== 関数とメッセージ (empty)

=== 型とクラス (empty)

